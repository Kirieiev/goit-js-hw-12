{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '42516548-e76607dce4d0f5a31ac9147e6';\nconst URL = 'https://pixabay.com/api/';\nexport const maxElementPage = 15;\n\nexport function serchPicture(picture, page = 1) {\n  return axios\n    .get(URL, {\n      params: {\n        key: API_KEY,\n        q: picture,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: maxElementPage,\n        page,\n      },\n    })\n    .then(res => {\n      return res.data;\n    });\n}\n","'use strict';\n\nexport function createPictureMarkup(hits, containerEl) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) => `<a href=\"${largeImageURL}\" class= \"picture-link\">\n    <img src = \"${webformatURL}\" alt=\"${tags}\">\n    <div class= \"picture-content\">\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Likes</span>\n            <span class= \"picture-sub-title\">${likes}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Views</span>\n            <span class= \"picture-sub-title\">${views}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Comments</span>\n            <span class= \"picture-sub-title\">${comments}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Downloads</span>\n            <span class= \"picture-sub-title\">${downloads}</span>\n        </div>\n    </div>\n</a>`\n    )\n    .join('');\n  containerEl.insertAdjacentHTML('beforeend', markup);\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { serchPicture, maxElementPage } from './js/pixabay-api.js';\nimport { createPictureMarkup } from './js/render-functions.js';\n\nconst form = document.querySelector('.form-inline');\nconst containerEl = document.querySelector('.card-container');\nconst loadMoreBtn = document.querySelector('.label');\nconst preloader = document.getElementById('preloader');\n\nconst queryParams = {\n  q: '',\n  page: 1,\n  maxPage: 0,\n  per_page: 20,\n};\n\nlet currentSearchQuery = '';\nconst hiddenClass = 'is-hidden';\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction enable(button, preloader) {\n  preloader.classList.add(hiddenClass);\n  button.disabled = false;\n}\n\nfunction disable(button, preloader) {\n  preloader.classList.remove(hiddenClass);\n  button.disabled = true;\n}\nfunction showLoadingIndicator() {\n  containerEl.innerHTML = '<div class=\"loader\"></div>';\n}\nfunction hideLoadingIndicator() {\n  const loadingElement = containerEl.querySelector('.loader');\n  if (loadingElement) {\n    loadingElement.remove();\n  }\n}\n\nform.addEventListener('submit', handleSearch);\nasync function handleSearch(event) {\n  event.preventDefault();\n  containerEl.innerHTML = '';\n  const form = event.currentTarget;\n  const picture = form.elements.picture.value.trim();\n  currentSearchQuery = picture;\n  queryParams.page = 1;\n  if (picture === '' || picture === null) {\n    iziToast.error({\n      title: 'Error',\n      message: `❌ Sorry, there are no images matching your search query. Please, try again!`,\n      maxWidth: 300,\n      progressBar: true,\n      progressBarEasing: false,\n      position: 'topRight',\n      backgroundColor: '#ff6d60',\n    });\n    containerEl.innerHTML = '';\n    hide(loadMoreBtn);\n    return;\n  }\n\n  showLoadingIndicator();\n  try {\n    const { hits, totalHits } = await serchPicture(picture);\n    console.log(hits);\n    console.log(totalHits);\n    if (hits.length < maxElementPage) {\n      iziToast.error({\n        title: 'Error',\n        message: `\"We're sorry, but you've reached the end of search results.\"`,\n        maxWidth: 300,\n        progressBar: true,\n        progressBarEasing: false,\n        position: 'topRight',\n        backgroundColor: '#ff6d60',\n      });\n    }\n    if (hits && hits.length > 0) {\n      queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n      createPictureMarkup(hits, containerEl);\n      const lightbox = new SimpleLightbox('.card-container a', {\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250,\n      });\n      lightbox.refresh();\n      if (hits && hits.length > 0 && hits.length !== totalHits) {\n        show(loadMoreBtn);\n        loadMoreBtn.removeEventListener('click', handleLoadMore);\n        loadMoreBtn.addEventListener('click', handleLoadMore);\n      } else {\n        hide(loadMoreBtn);\n      }\n    } else {\n      containerEl.innerHTML = '';\n      iziToast.error({\n        title: 'Error',\n        message: `❌ Sorry, there are no images matching your search query. Please, try again!`,\n        maxWidth: 300,\n        progressBar: true,\n        progressBarEasing: false,\n        position: 'topRight',\n        backgroundColor: '#ff6d60',\n      });\n      hide(loadMoreBtn);\n    }\n  } catch (err) {\n    console.log(err);\n  } finally {\n    hideLoadingIndicator();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  queryParams.page += 1;\n  disable(loadMoreBtn, preloader);\n  try {\n    const { hits } = await serchPicture(currentSearchQuery, queryParams.page);\n    createPictureMarkup(hits, containerEl);\n    const cardHeight = containerEl\n      .querySelector('.picture-link')\n      .getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 3, behavior: 'smooth' });\n    const lightbox = new SimpleLightbox('.card-container a', {\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    enable(loadMoreBtn, preloader);\n    console.log(queryParams.page);\n    console.log(queryParams.maxPage);\n    if (queryParams.page >= queryParams.maxPage) {\n      hide(loadMoreBtn);\n      iziToast.error({\n        title: 'Error',\n        message: `\"We're sorry, but you've reached the end of search results.\"`,\n        maxWidth: 300,\n        progressBar: true,\n        progressBarEasing: false,\n        position: 'topRight',\n        backgroundColor: '#ff6d60',\n      });\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n    } else {\n      show(loadMoreBtn);\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  }\n}\n"],"names":["API_KEY","URL","maxElementPage","serchPicture","picture","page","axios","res","createPictureMarkup","hits","containerEl","markup","webformatURL","tags","likes","views","comments","downloads","largeImageURL","form","loadMoreBtn","preloader","queryParams","currentSearchQuery","hiddenClass","hide","button","show","enable","disable","showLoadingIndicator","hideLoadingIndicator","loadingElement","handleSearch","event","iziToast","totalHits","SimpleLightbox","handleLoadMore","err","cardHeight"],"mappings":"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"}